# Grouping breast cancer patient into subtypes using unsupervised learning
## INTRODUCTION
Breast cancer is one of the leading cause of death cancer death among women. Unfortunately, breast cancer is very heterogeneous disease  and varies greatly among different patients (intertumor heterogeneity) and even sometime varies within each individual tumor (intratumor heterogeneity) (turashvili et al 2017). No wonder understanding the molecular mechanism of breast cancer has remain an enigma. The heterogeneity properties has made breast cancer difficult to cure and diagonis. Heterogeneity include tumorigenecity, different treatment resistance and different metastatic behavior. Understanding the the molecular mechanism of tumor heterogeneity would shed more light on the diagnosis, prognosis and therapeutic strategy for breast cancer. In this project, using machine learning technique, principal component analysis (PCA) and K-mean  (unsupervised learning) I create 3 substypes of breast cancer samples from the data published by Mertins et. Al 2016.

## PROBLEM STATEMENT
The aim is to cluster the breast cancer patient samples into sub-type according to their proteins activities. Biologically speaking, clustering based on protein properties could help understand similarity among diverse samples which can in the log run help in deciding the diagnostic model. Analyzing breast cancer data and coming up new pattern based on their proteome profile could provide better opportunity for diagnosis. 
To this end, I employed PCA combined with clustering algorithm K-means and Birch to group the breast cancer samples into groups (for more datal on PCA, K-means and Birch see data processing section)

## METHODS
The datasets and inputs:
The data  contains iTRAQ proteome of 77 breast samples that were generated by Clinical Proteomic Tumor Analysis Consortium (NCI/NIH). This data acn also be found in Kaggle (https://www.kaggle.com/piotrgrabo/breastcancerproteomes).  The data has 3 files:
1.	77cancerproteomesCPTACitraq.csv: this contains iTRAQ proteome profiling of all the 77 breast cancer samples. This has 12553 rows and 85 column. The following columns are present in  77cancerproteomesCPTACitraq.csv:
    - RefSeqaccessionnumber: This column contains RefSeq protein ID
    - gene_symbol: This column contains gene symbols
    - gene_name: This column contains gene names.
    - Remaining columns: contain log2 iTRAQ ratios for each breast cancer sample (signified with patient ID) i.e protein expression data. Except the last three columns that contain iTRAQ ratios from healthy individuals.

2.	clinicaldatabreast_cancer.csv: this contains information about the cancer 	classification of each sample. It has 105 rows and 29 columns.
    - The first column is “Complete TCGA ID). This is the patient ID will be matched with the patient ID in  cancerproteomesCPTACitraq.csv
    - Other columns contain data about the cancer classification for each sample using different methods.

3.	PAM50_proteins.csv: this contains the list of genes and proteins used in pam50 	classification. It has 100 rows and 4 columns.
    - Column “RefSeqProteinID contains proteins IDs which can be matched to “RefSeqaccessionnumber” column in  77cancerproteomesCPTACitraq.csv.
    
## Analysis
The whole analysis was done in amazon SageMaker.

### Libraries and methods used are: 
- SageMaker: a cloud machine-learning platform that provide a developers with a platform to create, train, and deploy machine-learning models in the cloud. 
- Numpy: a python library used for working with arrays.
- Pandas: a python library used for data manipulation
- OS:  is a module that provide function to interact with operating system.
- Io: a python module that facilitate handling of input and output operation.
- Matplotlib: A library for creating plots
- Sklearn: is a machine learning library
- Seaborn: is a visualization library
- Boto3: AWS SDK for python
- re: python module for regular expression
- Hypertools: Is a python toolbox for visualizing high-dimensional data.

Data were download onto computer from kaggle (https://www.kaggle.com/piotrgrabo/breastcancerproteomes), uploaded into SageMaker from local computer and then imported into jupyter notebook Data preprocessing
### Algorithm and techniques used and justifications:
- Data inputation using kNN: kNN extract information from the patient samples that has similar expression profile as the one that has missing values and then impute each missing value by averaging k protein expression value from the same replicate to where the missing value has occurred. According to Lazar et al., 2016 while it is good idea to understand the cause of the missing value, it it is missing at random (MAR) or missing not at random (MNAR). Algorithm such as K-means performs very well in both case. In addition, in most proteomic data the cause of missing value is a combination of both MNAR and MAR.
- PCA for dimensional reduction: PCA is an algorithm that find the best linear combinations of the original feature/variable such that the variance or spread along the new feature/variable is maximum. I used this to reduce the dimension of data to 10 variables from 43 variables. It is a good idea prior to K-means to perform dimension reduction because Euclidean distances tend to become inflated in high dimensional data.
- K-means to group together sample based on the protein expression profile: This is an algorithm that cluster data by grouping them in a specific number of groups of equal variance. Using K-means will help in grouping the patient cancer samples into groups (Scikit-learn).
- Birch: Another algorithm for clustering. It build Clustering Feature Tree (CFT) for any given data (Scikit-learn).
      
After reading the data file, the first thing was to get some statistics using .shape method and .head() method to print first few rows.
Before analysis. distribution of protein expression in all the breast cancer samples was visualized.
    
## Benchmark
For this analysis, result shown in fig. 6A to 6d and fig. 7A in the article published by Mertins et al., 2016 where the original data was first published will be used as benchmark. In this article the consensus clustering of the proteomic data set was 3 which is consistent with the output of this analysis. They noticed obvious separation of cluster at K=3.

## RESULTS
PCA was used to reduce the dimension of the data. 10 of the features (proteins) represent 83%  variance of the data.
With K-means the 77 patient samples were grouped into 3 clusters based on their protein profile. This is consistent with the finding of Mertins et al., 2016.  Mertins et al., 2016 shows that K=3 produce the optimal clusters. Their Silhouette plots for K= 3 and K= 4 clusters shows a clearer separation of clusters for K= 3.

## CONCLUSION
The above algorithms have successfully reduced the complexity of breast cancer samples and grouped the sample into 3 possible subgroups which can serve as a basis for classification of breast cancer samples. Both Birch and K-means cluster the data similarly. And the result of this analysis is consistent with  Mertins et al., 2016 where the proteomic data was clustered into basal-enriched, luminal-enriched, and stromal-enriched clusters.


## REFERENCES

    1 Cosmin Lazar, Laurent Gatto, Myriam Ferro, Christophe Bruley, and Thomas Burger Journal of Proteome Research 2016 15 (4), 1116-1125 DOI:       10.1021/acs.jproteome.5b00981 
    2 Kajot. (2019, November 14). Breast Cancer Proteomes. Retrieved November 23, 2020, from https://www.kaggle.com/piotrgrabo/breastcancerproteomes
    3 Mertins, P., Mani, D. R., Ruggles, K. V., Gillette, M. A., Clauser, K. R., Wang, P., . . . Carr, S. A. (2016). Proteogenomics connects somatic mutations to signalling in breast cancer. Nature, 534(7605), 55-62. doi:10.1038/nature18003
    4 2.3. Clustering¶. (n.d.). Retrieved November 23, 2020, from https://scikit-learn.org/stable/modules/clustering.html
    5 Turashvili, G., & Brogi, E. (2017). Tumor Heterogeneity in Breast Cancer. Frontiers in Medicine, 4. doi:10.3389/fmed.2017.00227
